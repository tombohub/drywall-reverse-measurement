Implementation layer and utility functions
